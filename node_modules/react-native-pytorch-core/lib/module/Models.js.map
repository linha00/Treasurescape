{"version":3,"sources":["Models.ts"],"names":["Image","resolveAssetSource","MODEL_PATH_CACHE","getModelAssetSource","modelPath","source","getModelUri","uri"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SACEA,KADF,QAIO,cAJP;AAMA,MAAM;AAACC,EAAAA;AAAD,IAAuBD,KAA7B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA;AACA;AACA;AACA,MAAME,gBAA2D,GAAG,EAApE;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,mBAAT,CACEC,SADF,EAE4B;AAC1B,MAAIC,MAAM,GAAGH,gBAAgB,CAACE,SAAD,CAA7B;;AACA,MAAIC,MAAM,IAAI,IAAd,EAAoB;AAClBA,IAAAA,MAAM,GAAGJ,kBAAkB,CAACG,SAAD,CAA3B;AACAF,IAAAA,gBAAgB,CAACE,SAAD,CAAhB,GAA8BC,MAA9B;AACD;;AACD,SAAOA,MAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASC,WAAT,CAAqBF,SAArB,EAAmD;AACxD,MAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;AACjC,WAAOA,SAAP;AACD,GAFD,MAEO;AACL,UAAMC,MAAM,GAAGF,mBAAmB,CAACC,SAAD,CAAlC;AACA,WAAOC,MAAM,CAACE,GAAd;AACD;AACF","sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\n\nimport {\n  Image,\n  ImageResolvedAssetSource,\n  ImageRequireSource,\n} from 'react-native';\n\nconst {resolveAssetSource} = Image;\n\n/**\n * An ML model can be loaded from three different sources, and must be one of\n * the following options:\n *\n * * url to a model file (e.g., https://example.com/my_model.ptl)\n * * path to a local model file (e.g., /data/0/some/path/my_model.ptl)\n * * a path in the JavaScript bundle (e.g., `require('./my_model.ptl')`)\n */\nexport type ModelPath = string | ImageRequireSource;\n\nexport type ModelInfo = {\n  name: string;\n  model: ModelPath;\n  vocab?: string;\n};\n\n/**\n * Cache for previously resolved model paths (i.e., asset sources).\n */\nconst MODEL_PATH_CACHE: {[key: string]: ImageResolvedAssetSource} = {};\n\n/**\n * Resolves the model asset source. It will first try to find the asset source\n * in the cache if it was previously resolved, otherwise it will use the\n * `resolveAssetSource` provided by the React Native [[Image]].\n *\n * @param modelPath The model path (i.e., a `require`).\n */\nfunction getModelAssetSource(\n  modelPath: ImageRequireSource,\n): ImageResolvedAssetSource {\n  let source = MODEL_PATH_CACHE[modelPath];\n  if (source == null) {\n    source = resolveAssetSource(modelPath);\n    MODEL_PATH_CACHE[modelPath] = source;\n  }\n  return source;\n}\n\n/**\n * Checks if the passed in model path is a string or a resolvable asset source.\n * In case the path is a string it will be used as a URI. If it is a resolvable\n * asset source, it will resolve the asset source and get its URI.\n *\n * @param modelPath The model path as require or uri (i.e., `require`).\n * @returns A URI to resolve the model.\n */\nexport function getModelUri(modelPath: ModelPath): string {\n  if (typeof modelPath === 'string') {\n    return modelPath;\n  } else {\n    const source = getModelAssetSource(modelPath);\n    return source.uri;\n  }\n}\n"]}