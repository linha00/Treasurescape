{"version":3,"sources":["install-jsi.ts"],"names":["NativeModules","global","__torchlive__","PlayTorchJSIModule","PyTorchCoreJSI","Error","nativeCallSyncHook","install","result"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA,SAAQA,aAAR,QAA4B,cAA5B;;AAOA,IAAIC,MAAM,CAACC,aAAP,IAAwB,IAA5B,EAAkC;AAChC,QAAMC,kBAAkB,GAAGH,aAAa,CAACI,cAAzC;;AAEA,MAAID,kBAAkB,IAAI,IAA1B,EAAgC;AAC9B,UAAM,IAAIE,KAAJ,CACJ,6DADI,CAAN;AAGD,GAP+B,CAShC;;;AACA,MAAIJ,MAAM,CAACK,kBAAP,IAA6B,IAA7B,IAAqCH,kBAAkB,CAACI,OAAnB,IAA8B,IAAvE,EAA6E;AAC3E,UAAM,IAAIF,KAAJ,CACJ,+RADI,CAAN;AAGD,GAd+B,CAgBhC;;;AACA,QAAMG,MAAM,GAAGL,kBAAkB,CAACI,OAAnB,EAAf;AACA,MAAIC,MAAM,KAAK,IAAf,EACE,MAAM,IAAIH,KAAJ,CACH,oKAAmKG,MAAO,EADvK,CAAN,CAnB8B,CAuBhC;;AACA,MAAIP,MAAM,CAACC,aAAP,IAAwB,IAA5B,EACE,MAAM,IAAIG,KAAJ,CACJ,mKADI,CAAN;AAGH","sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @internal\n * @ignore\n * @packageDocumentation\n */\n\n// Adapted from react-native-quick-sqlite\n// https://github.com/ospfranco/react-native-quick-sqlite/blob/6b50202a7f4a09f5a7e5662f57da5dca9662f39b/src/index.ts\n\nimport {NativeModules} from 'react-native';\n\ndeclare global {\n  function nativeCallSyncHook(): unknown;\n  var __torchlive__: object | undefined;\n}\n\nif (global.__torchlive__ == null) {\n  const PlayTorchJSIModule = NativeModules.PyTorchCoreJSI;\n\n  if (PlayTorchJSIModule == null) {\n    throw new Error(\n      'PlayTorchJSIModule not found. Maybe try rebuilding the app.',\n    );\n  }\n\n  // Check if we are running on-device (JSI)\n  if (global.nativeCallSyncHook == null || PlayTorchJSIModule.install == null) {\n    throw new Error(\n      'Failed to install react-native-pytorch-core: React Native is not running on-device. The PlayTorchJSIModule can only be used when synchronous method invocations (JSI) are possible. If you are using a remote debugger (e.g. Chrome), switch to an on-device debugger (e.g. Flipper) instead.',\n    );\n  }\n\n  // Call the synchronous blocking install() function\n  const result = PlayTorchJSIModule.install();\n  if (result !== true)\n    throw new Error(\n      `Failed to install react-native-pytorch-core: The native PlayTorchJSIModule could not be installed! Looks like something went wrong when installing JSI bindings: ${result}`,\n    );\n\n  // Check again if the constructor now exists. If not, throw an error.\n  if (global.__torchlive__ == null)\n    throw new Error(\n      'Failed to install react-native-pytorch-core, the native initializer function does not exist. Are you trying to use PlayTorchJSIModule from different JS Runtimes?',\n    );\n}\n"]}